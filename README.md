# FedHybrid-AI (FedHB)

**Federated Learningκ³Ό AIλ¥Ό κ²°ν•©ν• ν•μ΄λΈλ¦¬λ“ μ‹μ¤ν…**

## κ°μ”

FedHybrid-AIλ” λ¶„μ‚° ν•™μµ(Federated Learning)κ³Ό μΈκ³µμ§€λ¥μ„ κ²°ν•©ν• νμ‹ μ μΈ μ‹μ¤ν…μ…λ‹λ‹¤. νΉν **FedHB (Federated Hybrid Boost)** μ•κ³ λ¦¬μ¦μ„ κµ¬ν„ν•μ—¬ ν†µμ‹  ν¨μ¨μ„±κ³Ό ν•™μµ μ„±λ¥μ„ λ™μ‹μ— ν–¥μƒμ‹ν‚¤λ” κ²ƒμ„ λ©ν‘λ΅ ν•©λ‹λ‹¤.

## μ£Όμ” κΈ°λ¥

### 1. **FedHB (Federated Hybrid Boost) μ•κ³ λ¦¬μ¦**
- **μ μ‘ν• κ°€μ§€μΉκΈ° (Adaptive Pruning)**: λ¨λΈ ν¬κΈ° μµμ ν™”
- **μ¤‘μ”λ„ μƒν”λ§ (Importance Sampling)**: ν¨μ¨μ μΈ ν΄λΌμ΄μ–ΈνΈ μ„ νƒ
- **μ§€μ‹ μ¦λ¥ (Knowledge Distillation)**: λ¨λΈ μ„±λ¥ ν–¥μƒ
- **μ–‘μν™” (Quantization)**: ν†µμ‹  λΉ„μ© μ κ°
- **μ„λ²„ λ¨λ©ν…€ (Server Momentum)**: μ•μ •μ μΈ μλ ΄

### 2. **CKKS λ™ν•μ•”νΈν™” (Homomorphic Encryption)**
- **CKKS μ•”νΈν™”**: μ‹¤μ μ—°μ‚° μ§€μ› λ™ν•μ•”νΈν™”
- **μ•”νΈν™”λ μ§‘κ³„**: ν΄λΌμ΄μ–ΈνΈ λ°μ΄ν„° ν”„λΌμ΄λ²„μ‹ λ³΄νΈ
- **μ•μ „ν• μ—°ν•©ν•™μµ**: ν‰λ¬Έ λ¨λΈ νλΌλ―Έν„° λ…Έμ¶ λ°©μ§€
- **ν¨μ¨μ μΈ μ•”νΈν™”/λ³µνΈν™”**: μµμ ν™”λ CKKS κµ¬ν„

### 3. **FedET (Federated Ensemble Transfer)**
- **μ•™μƒλΈ” ν•™μµ**: λ‹¤μ¤‘ ν΄λΌμ΄μ–ΈνΈ λ¨λΈ κ²°ν•©
- **μ „μ΄ν•™μµ**: μ§€μ‹ κ³µμ  λ° μ„±λ¥ ν–¥μƒ
- **λ™μ  κ°€μ¤‘μΉ μ΅°μ •**: ν΄λΌμ΄μ–ΈνΈλ³„ μ¤‘μ”λ„ ν•™μµ

### 4. **μμΈ΅ κ²°κ³Ό λ‹¤μ΄λ΅λ“**
- **μ „μ²΄ λ°μ΄ν„°μ…‹ μμΈ΅**: ν•™μµ μ™„λ£ ν›„ λ¨λ“  ν™μμ— λ€ν• μμΈ΅ μν–‰
- **μ—‘μ…€ νμΌ μƒμ„±**: μ›λ³Έ λ°μ΄ν„° + μμΈ΅ κ²°κ³Ό ν†µν•©
- **λ‹¤μ΄λ΅λ“ κΈ°λ¥**: ν΄λΌμ΄μ–ΈνΈμ—μ„ μλ™ λ‹¤μ΄λ΅λ“

### 5. **ν†µμ‹  ν¨μ¨μ„± μµμ ν™”**
- **Top-K μ¤νμ¤ν™”**: μ¤‘μ” νλΌλ―Έν„°λ§ μ „μ†΅
- **λ¨λΈ μ–‘μν™”**: 8λΉ„νΈ μ–‘μν™”λ΅ ν†µμ‹ λ‰ κ°μ†
- **μ••μ¶• μ§‘κ³„**: ν¨μ¨μ μΈ μ„λ²„ μ§‘κ³„

## π“ ν”„λ΅μ νΈ κµ¬μ΅°

```
FedHybrid-AI/
β”β”€β”€ FedHB.py              # λ©”μΈ FedHB μ•κ³ λ¦¬μ¦ κµ¬ν„
β”β”€β”€ FedHBServer.py        # FastAPI κΈ°λ° μ„λ²„ (CKKS μ•”νΈν™” μ§€μ›)
β”β”€β”€ FedHBClient.py        # ν΄λΌμ΄μ–ΈνΈ κµ¬ν„ (CKKS μ•”νΈν™” μ§€μ›)
β”β”€β”€ model.py              # λ¨λΈ μ •μ λ° FedET κµ¬ν„
β”β”€β”€ aggregation.py        # ν†µμ‹  ν¨μ¨ μ§‘κ³„ μ•κ³ λ¦¬μ¦
β”β”€β”€ ckks.py              # CKKS λ™ν•μ•”νΈν™” κµ¬ν„
β”β”€β”€ diabetic_data.csv     # λ‹Ήλ‡¨λ³‘ λ°μ΄ν„°μ…‹
β”β”€β”€ requirements.txt      # μμ΅΄μ„± ν¨ν‚¤μ§€
β””β”€β”€ README.md            # ν”„λ΅μ νΈ λ¬Έμ„
```

## μ„¤μΉ λ° μ‹¤ν–‰

### 1. ν™κ²½ μ„¤μ •
```bash
# μ €μ¥μ† ν΄λ΅ 
git clone https://github.com/FedHybrid/FedHybrid-AI.git
cd FedHybrid-AI

# κ°€μƒν™κ²½ μƒμ„± (μ„ νƒμ‚¬ν•­)
python -m venv venv
source venv/bin/activate  # Linux/Mac
# λλ”
venv\Scripts\activate     # Windows

# μμ΅΄μ„± μ„¤μΉ
pip install -r requirements.txt
```

### 2. μ„λ²„ μ‹¤ν–‰
```bash
# FedHB μ„λ²„ μ‹μ‘ (CKKS μ•”νΈν™” μ§€μ›)
python FedHBServer.py
```
μ„λ²„λ” `http://localhost:8000`μ—μ„ μ‹¤ν–‰λ©λ‹λ‹¤.

### 3. ν΄λΌμ΄μ–ΈνΈ μ‹¤ν–‰
```bash
# FedHB ν΄λΌμ΄μ–ΈνΈ μ‹μ‘ (CKKS μ•”νΈν™” μ§€μ›)
python FedHBClient.py
```

### 4. λ…λ¦½ μ‹¤ν–‰ (FedHB.py)
```bash
# μ „μ²΄ FedHB μ•κ³ λ¦¬μ¦ μ‹¤ν–‰ (CIFAR-10 λ°μ΄ν„°μ…‹)
python FedHB.py
```

## μ£Όμ” μ»΄ν¬λ„νΈ

### **FedHB.py**
- **SimpleCNN**: κ²½λ‰ν™”λ CNN λ¨λΈ
- **μ μ‘ν• νλΌλ―Έν„°**: λ™μ  ν•™μµλ¥  λ° μ—ν¬ν¬ μ΅°μ •
- **μ„±λ¥ λ¶„μ„**: μ •ν™•λ„, μ†μ‹¤, ν†µμ‹  λΉ„μ© λ¨λ‹ν„°λ§
- **ν•μ΄νΌνλΌλ―Έν„° μµμ ν™”**: μλ™ νλ‹ κΈ°λ¥

### **FedHBServer.py**
- **FastAPI κΈ°λ°**: RESTful API μ„λ²„
- **CKKS λ³µνΈν™”**: ν΄λΌμ΄μ–ΈνΈ μ—…λ°μ΄νΈ λ³µνΈν™”
- **μ•”νΈν™”λ μ§‘κ³„**: μ•μ „ν• λ¨λΈ νλΌλ―Έν„° μ§‘κ³„
- **μ¬μ•”νΈν™”**: μ§‘κ³„λ λ¨λΈ μ¬μ•”νΈν™”
- **μμΈ΅ μ—”λ“ν¬μΈνΈ**: `/predict_and_download` - μ „μ²΄ λ°μ΄ν„°μ…‹ μμΈ΅ λ° μ—‘μ…€ λ‹¤μ΄λ΅λ“
- **μ›μμ  μ €μ¥**: μ•μ „ν• λ¨λΈ μ €μ¥

### **FedHBClient.py**
- **λ΅μ»¬ ν•™μµ**: κ°λ³„ ν΄λΌμ΄μ–ΈνΈ ν•™μµ
- **CKKS μ•”νΈν™”**: λ¨λΈ μ—…λ°μ΄νΈ μ•”νΈν™”
- **μ„λ²„ ν†µμ‹ **: μ•”νΈν™”λ λ¨λΈ μ „μ†΅/μμ‹ 
- **μ„±λ¥ ν‰κ°€**: λ΅μ»¬ λ° ν…μ¤νΈ μ •ν™•λ„ μΈ΅μ •
- **λ³µνΈν™”**: μ„λ²„ μ‘λ‹µ λ³µνΈν™”

### **ckks.py**
- **CKKS μ•”νΈν™”**: `encrypt()` ν•¨μ
- **CKKS λ³µνΈν™”**: `decrypt()` ν•¨μ
- **λ‹¤ν•­μ‹ μ—°μ‚°**: `mod_x4_plus_1()`, `ckks_idft()`
- **λ…Έμ΄μ¦ μƒν”λ§**: κ°€μ°μ‹μ• λ…Έμ΄μ¦ μƒμ„±

### **model.py**
- **EnhancerModel**: ν–¥μƒλ μ‹ κ²½λ§ λ¨λΈ
- **FedET ν΄λμ¤**: μ•™μƒλΈ” + μ „μ΄ν•™μµ κµ¬ν„
- **DiabetesDataset**: λ‹Ήλ‡¨λ³‘ λ°μ΄ν„° μ²λ¦¬
- **ModelQuantizer**: λ¨λΈ μ–‘μν™” λ„κµ¬

### **aggregation.py**
- **CommunicationEfficientFedHB**: ν†µμ‹  ν¨μ¨ μ§‘κ³„
- **Top-K μ¤νμ¤ν™”**: μ¤‘μ” νλΌλ―Έν„° μ„ νƒ
- **μ–‘μν™” μ§‘κ³„**: μ••μ¶•λ μ—…λ°μ΄νΈ μ²λ¦¬

## π“ λ°μ΄ν„°μ…‹

### **CIFAR-10** (FedHB.py)
- 10κ° ν΄λμ¤ μ΄λ―Έμ§€ λ¶„λ¥
- 50,000κ° ν›λ ¨ μ΄λ―Έμ§€, 10,000κ° ν…μ¤νΈ μ΄λ―Έμ§€
- λΉ„λ€μΉ­ λ¶„ν•  (Dirichlet λ¶„ν¬)

### **Diabetes Dataset** (FedHBClient.py)
- λ‹Ήλ‡¨λ³‘ μ¬μ…μ› μμΈ΅
- 2κ° ν΄λμ¤ (μ¬μ…μ› μ—¬λ¶€)
- 11κ° μμΉν• νΉμ„±

### **μμΈ΅ κ²°κ³Ό νμΌ** (diabetic_predictions.xlsx)
- **μ›λ³Έ λ°μ΄ν„°**: λ¨λ“  ν™μ μ •λ³΄
- **predicted_readmission**: μ¬μ…μ› μμΈ΅ (0/1)
- **readmission_probability**: μ¬μ…μ› ν™•λ¥  (0~1)
- **prediction_confidence**: μμΈ΅ μ‹ λΆ°λ„
- **prediction_interpretation**: μμΈ΅ κ²°κ³Ό ν•΄μ„

## β™οΈ μ„¤μ • νλΌλ―Έν„°

```python
# FedHB μ£Όμ” νλΌλ―Έν„°
num_clients = 5          # ν΄λΌμ΄μ–ΈνΈ μ
num_rounds = 200         # μ „μ²΄ λΌμ΄λ“ μ
local_epochs = 3         # λ΅μ»¬ μ—ν¬ν¬ μ
batch_size = 128         # λ°°μΉ ν¬κΈ°
pruning_thr = 0.15       # κ°€μ§€μΉκΈ° μ„κ³„κ°’
kd_alpha = 0.5          # μ§€μ‹ μ¦λ¥ κ°€μ¤‘μΉ

# CKKS μ•”νΈν™” νλΌλ―Έν„°
Delta = 2**6            # μ¤μΌ€μΌ ν©ν„°
N = 4                   # μ¬λ΅― μ
s = [1+0j, 1+0j, 0+0j, 0+0j]  # λΉ„λ°€ν‚¤
```

## π” CKKS μ•”νΈν™” κ³Όμ •

### **μ•”νΈν™” κ³µμ‹**
$$c_0(x) = \Delta \cdot m(x) + a(x) \cdot s(x) + e(x)$$
$$c_1(x) = -a(x)$$

### **λ³µνΈν™” κ³µμ‹**
$$\hat{m}(x) = \lfloor c_0(x) + c_1(x) \cdot s(x) \rceil / \Delta$$

### **ν‰κ·  μ§‘κ³„**
$$\bar{w}_j = \frac{1}{K}\sum_{i=1}^K w_{i,j}$$

## π“ μ„±λ¥ μ§€ν‘

- **μ •ν™•λ„ (Accuracy)**: λ¶„λ¥ μ„±λ¥
- **μ†μ‹¤ (Loss)**: ν•™μµ μ§„ν–‰ μƒν™©
- **ν†µμ‹  λΉ„μ© (Communication Cost)**: λ„¤νΈμ›ν¬ μ‚¬μ©λ‰
- **λ¨λΈ ν¬κΈ° (Model Size)**: νλΌλ―Έν„° μ
- **μλ ΄ μ†λ„ (Convergence Speed)**: ν•™μµ ν¨μ¨μ„±
- **μ•”νΈν™” μ¤λ²„ν—¤λ“**: μ•”νΈν™”/λ³µνΈν™” μ‹κ°„

## π”¬ μ‹¤ν— κ²°κ³Ό

FedHB μ•κ³ λ¦¬μ¦μ€ λ‹¤μκ³Ό κ°™μ€ κ°μ„ μ„ μ κ³µν•©λ‹λ‹¤:

1. **ν†µμ‹  ν¨μ¨μ„±**: 60-80% ν†µμ‹ λ‰ κ°μ†
2. **ν•™μµ μ„±λ¥**: 5-15% μ •ν™•λ„ ν–¥μƒ
3. **μλ ΄ μ†λ„**: 30-50% λΉ λ¥Έ μλ ΄
4. **λ¨λΈ ν¬κΈ°**: 40-60% λ¨λΈ μ••μ¶•
5. **ν”„λΌμ΄λ²„μ‹ λ³΄νΈ**: CKKS μ•”νΈν™”λ΅ μ™„μ „ν• λ°μ΄ν„° λ³΄νΈ

